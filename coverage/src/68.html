<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\pierc\source\repos\RGBDS2CIL\RGBDS2CIL\Lines\SubtractCompareLine.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

namespace RGBDS2CIL
{
	public class SubtractCompareLine : CodeLine
	{
		public string From;
		public string Value;

		public SubtractCompareLine(CodeLine codeLine) : base(codeLine.Code, codeLine, codeLine.Strings)
		{
			base.Comment = codeLine.Comment;
			base.Raw = codeLine.Raw;

			var values = codeLine.Code.Trim()[&quot;CP&quot;.Length..].Trim();

			//remove function params
			const string regexString = &quot;\\(.*?\\)|(,)&quot;;

			var rx = new Regex(regexString, RegexOptions.Compiled | RegexOptions.IgnoreCase);

			var matches = rx.Matches(values);

			var valueToTest = values;
			foreach (Match match in matches)
			{
				valueToTest = valueToTest.Replace(match.Value, &quot;&quot;);
			}

			var split = valueToTest.Split(&#39;,&#39;);

			From = &quot;A&quot;; //default?
			if (split.Length == 2)
			{
				From = split[0].Trim();
				Value = split.Last().Trim();
			}
			else
				Value = values;
		}
	}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,51,12,98,1],[13,3,13,4,1],[14,4,14,36,1],[15,4,15,28,1],[17,4,17,60,1],[22,4,22,85,1],[24,4,24,37,1],[26,4,26,29,1],[27,4,27,11,1],[27,13,27,24,1],[27,25,27,27,1],[27,28,27,35,1],[28,4,28,5,1],[29,5,29,56,1],[30,4,30,5,1],[32,4,32,39,1],[34,4,34,15,1],[35,4,35,26,1],[36,4,36,5,0],[37,5,37,28,0],[38,5,38,33,0],[39,4,39,5,0],[41,5,41,20,1],[42,3,42,4,1]]);
    </script>
  </body>
</html>